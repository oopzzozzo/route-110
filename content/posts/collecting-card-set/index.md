+++
title = '集卡組'
date = 2026-01-21T20:49:59+08:00
categories = ['筆記']
labels = ['數字']
draft = true
+++

### 題目
> 卡片販賣機有 \\( \frac{1}{12} \\) 的機率掉任一張卡，問集滿全套 12 張卡的期望購買次數為何？
> 隨卡片張數增加，期望次數的增加趨勢為何？

這是簡單的高中數學，但我看到販賣機的當下居然想錯，所以來筆記一下。

### 集卡過程
要集滿 12 張卡，我們要
- 集到第 1 張卡
- 集到第 2 張卡
- 集到第 3 張卡
- ...
- 集到第 12 張卡

假設已經有 \\( x \\) 張卡的情況下，集到第 \\( x+1 \\) 張卡要抽 \\( a_x \\) 次。那麼從 0 張卡集到第 12 張卡的次數就是
$$ a_0 + a_1 + a_2 \dots + a_{11} $$

### 集到一張新卡的期望次數
假設我已經有 5 張卡了，集到第 6 張卡要抽 \\( a_5 \\) 次，\\( a_5 \\) 是多少呢？

每一次有 \\( \frac{5}{12} \\) 的機率會抽到重複的，\\( \frac{7}{12} \\) 的機率會抽中新卡。\\( \frac{7}{12} \\) 的中獎率，期望要抽的次數就是 \\( \frac{12}{7} \\)。

#### 為什麼中獎率的倒數即是期望抽數？
$$ 期望抽數 = 一抽入機率 \times 1抽 + (未能一抽入機率) \times (1抽 + 再接再厲的望抽數) $$

抽到重複的情況對下一次抽沒有任何幫助，所以再接再厲的期望抽數就是當下的期望抽數。算式整理一下，可得
$$ 期望抽數 = 1抽 + (1 - 一抽入機率) \times 期望抽數 $$

$$ 期望抽數 = \frac{1}{一抽入機率} $$

$$ a_5 = \frac{12}{7} $$

### 集滿 12 張卡的期望次數
$$
\begin{aligned}
& a_0 + a_1 + a_2 \dots + a_{11} \\\\
&= \frac{1}{\frac{12}{12}} + \frac{1}{\frac{11}{12}} + \frac{1}{\frac{10}{12}} \dots + \frac{1}{\frac{1}{12}} \\\\
&= 12 \times \left( \frac{1}{12} + \frac{1}{11} + \frac{1}{10} \dots + \frac{1}{1} \right) \\\\
&\approx 37.24
\end{aligned}
$$

### 卡集張數與期望次數的關係
$$ N \times (\frac{1}{N} + \frac{1}{N-1} + \frac{1}{N-2} \dots + \frac{1}{1}) $$

右項為[調和級數](https://zh.wikipedia.org/zh-tw/調和級數)，複雜度為 \\( \log N \\)。故集滿 N 張卡集的期望次數複雜度為 \\( O(N \log N) \\)。

### 解答
集滿全套 12 張卡的期望購買次數為 \\( 12 \times (\frac{1}{12} + \frac{1}{11} + \frac{1}{10} \dots + \frac{1}{1}) \approx 37.24 \\)

卡片張數為 \\( N \\)，期望次數 \\( N\sum_{n=1}^{N} \frac{1}{n} \\) 的增加趨勢為 \\( O(N \log N) \\)。

{{< katex >}}

